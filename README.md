# 🏪 连锁茶楼管理系统

一个功能完善的连锁茶楼管理系统，支持6家连锁门店的统一管理。

## ✨ 系统功能

### 📊 核心模块
- **门店管理**：创建、查询、更新门店信息
- **员工管理**：员工入职、离职、职位管理
- **会员管理**：会员注册、充值、积分、等级管理
- **商品管理**：商品创建、分类、价格管理
- **库存管理**：入库、出库、库存预警
- **订单管理**：订单创建、支付、完成、取消
- **财务报表**：日报表、月报表、门店对比、收入趋势

---

## 🚀 快速开始

### 方式一：使用 Web 界面（推荐）

#### Linux/Mac 系统
```bash
chmod +x start_web.sh
./start_web.sh
```

#### Windows 系统
双击运行 `start_web.bat` 文件

#### 启动成功后
- 打开浏览器访问：`http://localhost:8501`
- 首次使用需要创建一些基础数据：
  1. 先创建几家门店（门店管理 → 新增门店）
  2. 创建商品（商品管理 → 新增商品）
  3. 创建员工（员工管理 → 新增员工）
  4. 创建会员（会员管理 → 新增会员）
  5. 入库商品（库存管理 → 库存入库）
  6. 开始营业（订单管理 → 创建订单）

---

### 方式二：使用 Agent 智能助手

通过自然语言与系统对话，系统会自动理解你的需求并执行相应操作。

**示例：**
```
你: 帮我创建一家门店，门店名称是"西湖茶楼"，编码是"ST001"
系统: ✅ 门店创建成功！

你: 查询所有门店
系统: 📋 门店列表：...
```

启动 Agent：
```bash
export PYTHONPATH=/workspace/projects/src:$PYTHONPATH
python -c "
from agents.agent import build_agent
from coze_coding_utils.runtime_ctx.context import new_context
from langchain_core.messages import HumanMessage

ctx = new_context('test')
agent = build_agent(ctx)
config = {'configurable': {'thread_id': 'session-001'}}

while True:
    user_input = input('你: ')
    message = HumanMessage(content=user_input)
    response = agent.invoke({'messages': [message]}, config=config)
    print('系统:', response['messages'][-1].content)
"
```

---

## 📋 Web 界面操作指南

### 📊 控制台
- 查看今日营业数据
- 门店营业额排名
- 会员统计
- 最近订单列表

### 🏪 门店管理
- **门店列表**：查看所有门店信息
- **新增门店**：创建新门店（必填：名称、编码、地址、电话）

### 👥 员工管理
- **员工列表**：查看所有员工，支持按门店和职位筛选
- **新增员工**：创建新员工（必填：姓名、电话、职位、所属门店）

### 💎 会员管理
- **会员列表**：查看所有会员，支持按等级和关键词搜索
- **新增会员**：创建新会员（必填：姓名、手机号）
- **会员充值**：选择会员进行充值操作

### 🛍️ 商品管理
- **商品列表**：查看所有商品，支持按分类和名称搜索
- **新增商品**：创建新商品（必填：名称、编码、分类、单价、单位）

### 📦 库存管理
- **库存查询**：查看指定门店的库存，支持预警商品筛选
- **库存入库**：选择门店和商品进行入库操作

### 📝 订单管理
- **订单列表**：查看所有订单，支持按门店和状态筛选
- **创建订单**：
  1. 选择门店和会员
  2. 选择支付方式
  3. 添加商品明细（自动计算金额）
  4. 提交后会自动支付并扣减库存

### 💰 财务报表
- **日报表**：查看指定日期的营业数据
- **月报表**：查看指定月份的营业数据
- **门店对比**：对比各门店的营业额

---

## 🗄️ 数据库结构

系统使用 PostgreSQL 数据库，包含以下核心表：

| 表名 | 说明 |
|------|------|
| stores | 门店表 |
| employees | 员工表 |
| members | 会员表 |
| products | 商品表 |
| inventory | 库存表 |
| inventory_logs | 库存变动日志表 |
| orders | 订单表 |
| order_items | 订单明细表 |
| financial_records | 财务记录表 |
| member_transactions | 会员交易记录表 |

---

## 🛠️ 技术栈

- **后端**：Python + SQLAlchemy + PostgreSQL
- **Web界面**：Streamlit
- **Agent**：LangChain + LangGraph
- **数据库**：PostgreSQL

---

## 📞 常见问题

### Q1: Web界面启动失败？
**A:** 检查端口8501是否被占用，或修改启动脚本中的端口号

### Q2: 数据库连接失败？
**A:** 确认数据库服务是否正常运行，检查连接配置

### Q3: 如何备份数据？
**A:** 定期导出数据库数据，或使用数据库自带的备份功能

### Q4: 如何添加新功能？
**A:** 联系开发团队，或查看代码自行扩展

---

## 📝 版本信息

- **版本**：v1.0.0
- **更新日期**：2026-01-16
- **支持门店数**：6家

---

## 👨‍💻 开发团队

如有问题或建议，请联系系统管理员。
