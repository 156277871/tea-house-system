# 🎉 茶楼管理系统 V2.0 升级说明

**核心业务功能已全面升级！**

---

## ✨ 新增核心功能

### 1. 🪑 桌台管理
- 添加/查看桌台信息
- 设置桌台容量
- 查看桌台状态（空闲/使用中/预约/清洁中）

### 2. 🎯 开台管理
- 选择桌台开台
- 支持选择会员或散客
- 自动开始计时
- 更新桌台状态为"使用中"

### 3. 📝 进行中台位
- 实时查看所有进行中的台位
- 显示每个台位的时长
- 显示每个台位的消费金额
- 显示会员信息

### 4. 📋 点单功能
- 在开台的基础上点商品
- 自动扣减库存
- 实时更新消费金额
- 记录点单时间

### 5. 💰 结账功能
- 停止计时
- 显示完整的消费明细
- 计算最终消费金额
- 选择支付方式
- 生成订单记录
- 更新桌台状态为"空闲"

---

## 🔄 业务流程

```
创建基础数据 → 开台 → 点单 → 结账
     ↓              ↓       ↓       ↓
  门店、商品、   选桌台、  选商品、  停止计时
  桌台、员工、   选会员、  扣库存、  查账单
  会员、库存    开始计时  更新金额  支付
```

---

## 📦 更新步骤

### 方法1：直接替换文件（推荐）

1. **下载新的 app.py**
   ```
   https://coze-coding-project.tos.coze.site/coze_storage_7595903404677824527/tea-house-v2-app_*.py
   ```
   
2. **上传到 GitHub**
   - 访问您的仓库：https://github.com/您的用户名/tea-house-system
   - 点击 `app.py` 文件
   - 点击右上角的 "✏️" 编辑按钮
   - 将整个文件内容替换为新的 app.py
   - 在底部填写提交信息："升级到V2.0，新增开台、点单、结账功能"
   - 点击 "Commit changes"

3. **等待自动部署**
   - Streamlit Cloud 会自动检测到文件变化
   - 自动重新部署（约2-5分钟）
   - 刷新页面即可看到新功能

### 方法2：删除后重新上传

1. **删除旧文件**
   - 访问仓库：https://github.com/您的用户名/tea-house-system
   - 点击 `app.py` 文件
   - 点击右上角的垃圾桶图标 🗑️
   - 确认删除

2. **上传新文件**
   - 点击 "uploading an existing file"
   - 上传新的 `app.py` 文件
   - 点击 "Commit changes"

3. **等待自动部署**
   - 同上

---

## 🎯 使用顺序

### 第一次使用需要先创建基础数据：

1. **创建门店** 🏪
   - 菜单：🏪 门店管理 → 新增门店

2. **创建桌台** 🪑
   - 菜单：🪑 桌台管理 → 新增桌台
   - 设置桌台名称、容量

3. **创建商品** 🛍️
   - 菜单：🛍️ 商品管理 → 新增商品
   - 设置商品名称、单价、单位

4. **库存入库** 📦
   - 菜单：📦 库存管理 → 库存入库
   - 为各门店补充库存

5. **创建员工** 👥（可选）
   - 菜单：👥 员工管理 → 新增员工

6. **创建会员** 💎（可选）
   - 菜单：💎 会员管理 → 新增会员

### 日常业务流程：

1. **开台** 🎯
   - 菜单：🎯 开台管理 → 开台
   - 选择门店
   - 选择桌台
   - 选择会员（可选）
   - 点击"开台"
   - 开始计时 ✅

2. **点单** 📝
   - 菜单：🎯 开台管理 → 点单
   - 选择台位
   - 选择商品
   - 输入数量
   - 点击"点单"
   - 自动扣减库存 ✅

3. **结账** 💰
   - 菜单：🎯 开台管理 → 结账
   - 选择要结账的台位
   - 查看消费明细
   - 选择支付方式
   - 点击"确认结账"
   - 生成订单，桌台变为空闲 ✅

---

## 📊 新增页面

### 🎯 开台管理（新增）
包含4个子页面：
1. **开台** - 新开台位
2. **进行中台位** - 查看所有正在使用的台位
3. **点单** - 为台位点商品
4. **结账** - 台位结账

### 🪑 桌台管理（新增）
- 桌台列表
- 新增桌台

### 💰 财务报表（增强）
- 营业额统计
- 台位统计
- 台位使用情况

---

## ⚠️ 重要提示

### 数据兼容性
- V2.0 向下兼容 V1.0 的数据
- 您之前的门店、商品、员工、会员、订单数据不会丢失
- 新增的桌台、会话、会话点单数据会自动创建

### 第一次使用新功能
- 必须先创建桌台才能开台
- 必须先创建商品才能点单
- 必须先有库存才能点单（会自动扣减）

### 计时功能
- 开台后自动开始计时
- 结账时停止计时
- 时长精确到分钟

### 库存管理
- 点单时会自动扣减库存
- 库存不足时会提示但可以继续点单
- 建议定期补充库存

---

## 🆘 常见问题

### Q1: 升级后旧数据会丢失吗？
**A:** 不会！V2.0 向下兼容，您的门店、商品、员工、会员、订单数据都会保留。

### Q2: 为什么点单时提示"暂无商品"？
**A:** 需要先创建商品。菜单：🛍️ 商品管理 → 新增商品

### Q3: 为什么无法开台？
**A:** 需要先创建桌台。菜单：🪑 桌台管理 → 新增桌台

### Q4: 点单后库存没有减少？
**A:** 确保该门店有库存记录。菜单：📦 库存管理 → 库存入库

### Q5: 结账后台位还是"使用中"？
**A:** 正常情况下会自动变为"空闲"，如果没有，请刷新页面

### Q6: 如何查看台位的点单记录？
**A:** 在"点单"页面，选择台位后，下方会显示"已点商品"列表

### Q7: 计时准确吗？
**A:** 准确到分钟，基于服务器时间

---

## 🎊 开始使用吧！

升级完成后，按照"使用顺序"创建基础数据，然后就可以开始使用新的开台、点单、结账功能了！

**系统地址：**
```
https://bzcxvricjskuo2qbvl3nu8.streamlit.app/
```

---

## 💡 功能亮点

✅ **真正的茶楼业务流程** - 开台、计时、点单、结账
✅ **实时计时** - 准确记录每个台位的使用时长
✅ **自动扣减库存** - 点单时自动减少库存
✅ **清晰的账单** - 结账时显示完整的消费明细
✅ **台位状态管理** - 空闲、使用中、预约、清洁中
✅ **会员支持** - 开台时可选择会员，记录会员消费

---

**祝您使用愉快！** 🎉🍵
