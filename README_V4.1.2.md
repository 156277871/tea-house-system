# 连锁茶楼管理系统 V4.1.2

## 版本更新内容

### V4.1.2 - 新增库存台账和示例数据
- ✅ 新增库存台账页面，支持库存流水查看和详情展示
- ✅ 自动记录库存入库和出库流水
- ✅ 点击库存流水记录可查看详细信息
- ✅ 点击库存详情中的商品可查看该商品的库存流水历史
- ✅ 新增数据初始化脚本，生成完整的示例数据

### V4.1.1 - 修复文字显示问题
- ✅ 完全重写CSS样式，修复所有文字显示问题
- ✅ 确保所有页面文字清晰可见

### V4.1.0 - 界面优化和功能增强
- ✅ 优化导航栏结构，将设置相关功能归拢
- ✅ 新增桌台管理功能

## 快速开始

### 1. 安装依赖
```bash
pip install streamlit sqlalchemy pandas
```

### 2. 初始化示例数据
```bash
cd tea_house_lite
python init_sample_data.py
```

这将创建以下示例数据：
- **6家门店**：茶楼总店、东城店、西城店、南山店、北湖店、新城店
- **18种商品**：茶叶、花茶、零食、菜品等
- **8名会员**：不同等级（普通、银卡、金卡、钻石）
- **20条订单**：包含不同门店和会员
- **库存流水记录**：每个商品都有入库和出库记录
- **员工和桌台数据**

### 3. 启动系统
```bash
streamlit run app.py
```

系统将在浏览器中打开，默认地址：http://localhost:8501

## 功能模块

### 📊 控制台
- 查看所有门店的运营数据
- 今日营业额、订单数、台位状态统计

### 🎯 经营
- 查看各门店的桌台状态（空闲/使用中）
- 开台、点单、消费明细查看
- 结账功能（支持多种支付方式）
- 自动扣减库存并记录流水

### ⚙️ 设置
包含以下子页面：
- **门店管理**：创建和管理门店
- **桌台管理**：为各门店添加桌台
- **员工管理**：管理员工信息和岗位
- **商品管理**：添加商品信息
- **库存管理**：库存入库（自动记录流水）

### 💎 会员管理
- 查看会员列表
- 新增会员

### 📝 订单管理
- 查看订单记录

### 📦 库存台账（新增）
**库存流水**：
- 按门店、类型、日期筛选
- 查看所有库存变动记录
- 点击查看详情，显示：
  - 门店和商品信息
  - 变动详情（数量、时间、备注）
  - 库存变动对比
  - 商品详细信息
- 统计摘要（入库次数、出库次数、总变动数量）

**库存详情**：
- 按门店查看库存
- 显示商品信息和库存价值
- 库存预警（少于10件自动提示）
- 点击商品查看该商品的库存流水历史
- 统计总库存数量和价值

### 💰 财务报表
- 营业额统计（按日期）
- 台位统计（开台数、平均时长）

## 示例数据说明

### 门店数据（6家）
1. 茶楼总店 - 市中心商业街1号
2. 茶楼东城店 - 东城区朝阳路88号
3. 茶楼西城店 - 西城区复兴路123号
4. 茶楼南山店 - 南山区科技大道66号
5. 茶楼北湖店 - 北湖区环湖路88号
6. 茶楼新城店 - 新城开发区金桥路66号

### 商品分类
- **茶叶**：龙井绿茶、普洱熟茶、铁观音、大红袍、茉莉花茶
- **花茶**：菊花茶、玫瑰花茶、柠檬茶
- **零食**：瓜子、花生、开心果、腰果、话梅、薯片
- **菜品**：水煮鱼、宫保鸡丁、麻婆豆腐、鱼香肉丝

### 会员等级
- 普通会员
- 银卡会员
- 金卡会员
- 钻石会员

## 使用流程示例

### 1. 查看库存台账
1. 点击侧边栏"📦 库存台账"
2. 在"库存流水"标签中，可以：
   - 筛选门店、类型、日期
   - 点击"🔍 查看详情"查看流水详细信息
3. 在"库存详情"标签中：
   - 选择门店
   - 点击商品名称查看该商品的库存流水历史

### 2. 库存入库流程
1. 进入"⚙️ 设置" > "库存管理"
2. 选择门店和商品
3. 输入入库数量和备注
4. 点击"入库"按钮
5. 系统自动记录库存流水

### 3. 查看出库流水
1. 在"经营"页面进行开台、点单
2. 结账时自动扣减库存
3. 进入"📦 库存台账" > "库存流水"
4. 筛选类型为"出库"即可看到记录

### 4. 查看商品库存历史
1. 进入"📦 库存台账" > "库存详情"
2. 选择门店
3. 点击商品行的"🔍 查看详情"
4. 显示该商品最近10条库存流水记录

## 技术栈
- Python 3.8+
- Streamlit (Web框架)
- SQLAlchemy (ORM)
- SQLite (数据库)
- Pandas (数据处理)

## 界面设计
- 亮色主题（白色背景）
- 主按钮：红色背景+白色文字
- 侧边栏：浅灰色背景
- 所有文字：深色（#1f1f1f），确保清晰可见

## 数据库结构
- stores（门店）
- employees（员工）
- members（会员）
- products（商品）
- inventory（库存）
- inventory_logs（库存流水）- 新增
- tables（桌台）
- sessions（会话）
- session_items（会话明细）
- orders（订单）
- order_items（订单明细）

## 注意事项
1. 首次使用请先运行 `init_sample_data.py` 初始化示例数据
2. 库存入库会自动记录到inventory_logs表
3. 结账时会自动扣减库存并记录出库流水
4. 库存预警默认阈值为10件
5. 所有页面文字均已优化，确保清晰可见

## 更新日志
- **V4.1.2**：新增库存台账页面和数据初始化脚本
- **V4.1.1**：修复所有文字显示问题
- **V4.1.0**：界面优化，新增桌台管理
- **V4.0**：重构导航栏，将设置功能整合
